---
title: 条件请求和 HTTP/304 Not Modified
date: 2019-06-03 18:26:59
tags: HTTP
---

**条件请求**是通过 HTTP 请求中特定的首部字段实现的，这些首部字段规定了请求的前置条件，响应结果会因特定首部的值的不同而发生变化。条件请求通常用来检测服务器上存储的资源是否与客户端某一特定版本相匹配。在对某个服务器资源发送条件请求时，如果客户端已经存在该资源（缓存）而且没有过期，服务器将返回 **HTTP/304 Not Modified** 响应。

# 再验证

缓存无法保存世界上每份文档的副本，即便可以有些文档也可能会经常发生变化。缓存要不时地对其进行检测，看他们保存的副本是否仍是服务器上最新的副本。这些“新鲜度检测”被称为 **HTTP 再验证**。

理论上，缓存可以在任意时刻，以任意的频率对副本进行再验证。但由于网络带宽限制，大部分缓存只有在客户端发起请求，并且副本旧得足以需要检测的时候，才会对副本进行再验证。缓存再验证可能有 3 种情况：

![](/304.png)

-   **再验证命中**
    如果服务器对象未被修改，服务器会向客户端发送一个小（大概有 200 字节）的 **HTTP/304 Not Modified** 响应。

-   **再验证未命中**
    如果服务器对象与已缓存副本不同，服务器向客户端发送一条普通的、带有完整内容的 HTTP/200 OK 响应。

-   **对象被删除**
    如果服务器对象已经被删除了，服务器就会返回一个 HTTP/404 Not Found 响应，缓存也会将其副本删除。

# 条件首部
